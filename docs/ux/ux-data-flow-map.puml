@startuml
title UX Data Flow Map ‚Äî MEGASIM One (Dados entre UX, Fiscal, Financeiro e IA)

skinparam backgroundColor #FAFAFA
skinparam rectangle {
  FontColor #333333
  FontSize 14
  BorderColor #AAAAAA
  RoundCorner 10
}
skinparam ArrowColor #777777
skinparam shadowing false

rectangle "üë§ Usu√°rio / Tenant\n(Admin, Fiscal, Financeiro)" as USER
rectangle "üé® Interface UX\n(Web App / Mobile / Painel)" as UI
rectangle "‚öôÔ∏è Orquestrador UX / API Gateway" as UXAPI
rectangle "üßæ M√≥dulo Fiscal\n(NF-e, NFC-e, NFS-e)" as FISCAL
rectangle "üí∞ M√≥dulo Financeiro\n(Contas, Pagamentos, Cobran√ßas)" as FIN
rectangle "üß† M√≥dulo IA / Suporte Inteligente" as AI
rectangle "üóÉÔ∏è Data Lake / Banco Multi-Tenant" as DB
rectangle "üìä Observabilidade / Logs / Auditoria" as OBS
rectangle "‚òÅÔ∏è Integra√ß√µes Externas\n(SEFAZ, Prefeituras, Gateways, E-mail)" as EXT

' --- FLUXOS DE DADOS PRINCIPAIS ---

USER --> UI : Inputs (dados fiscais, clientes, servi√ßos, valores)
UI --> UXAPI : Requisi√ß√µes REST / GraphQL
UXAPI --> FISCAL : Dados fiscais validados
FISCAL --> EXT : XML / JSON ‚Üí SEFAZ / Prefeitura
EXT --> FISCAL : Autoriza√ß√£o / rejei√ß√£o / protocolo
FISCAL --> FIN : Dados de faturamento
FIN --> DB : Registro de contas a receber/pagar
FISCAL --> DB : Armazena XML, DANFE, protocolo
UXAPI --> AI : Contexto e logs para aprendizado
AI --> UXAPI : Sugest√µes e automa√ß√µes UX
UXAPI --> OBS : Logs de uso e eventos
OBS --> DB : Armazena telemetria e hist√≥rico
AI --> OBS : Indicadores e recomenda√ß√µes
FIN --> OBS : Logs de concilia√ß√£o / pagamentos
EXT --> OBS : Erros / status integra√ß√µes

' --- FLUXOS DE SUPORTE ---
USER --> UI : Acessa Ajuda / Chat
UI --> AI : Consulta IA e artigos
AI --> UXAPI : Requisi√ß√£o de logs t√©cnicos
UXAPI --> OBS : Coleta e envia logs relevantes
AI --> USER : Solu√ß√£o sugerida / A√ß√£o corretiva

' --- ANOTA√á√ïES ---
note right of FISCAL
<b>Dados sens√≠veis:</b>\n‚Ä¢ CNPJ / IE / IM / CFOP / NCM / ISS\n‚Ä¢ XML / DANFE / protocolos\n‚Ä¢ Reten√ß√£o de impostos
end note

note right of FIN
<b>Dados financeiros:</b>\n‚Ä¢ Contas a receber/pagar\n‚Ä¢ Faturas e cobran√ßas\n‚Ä¢ Pagamentos e concilia√ß√£o\n‚Ä¢ NFS-e da plataforma
end note

note right of AI
<b>Dados processados:</b>\n‚Ä¢ Logs, rejei√ß√µes, padr√µes de erro\n‚Ä¢ Intera√ß√µes de suporte\n‚Ä¢ Aprendizado de recomenda√ß√µes
end note

note right of OBS
<b>Governan√ßa:</b>\n‚Ä¢ Auditoria completa de a√ß√µes\n‚Ä¢ Telemetria UX (tempo, sucesso, falhas)\n‚Ä¢ Alertas autom√°ticos para suporte
end note

@enduml
![UX Data Flow Map](https://raw.githubusercontent.com/YuriGrandinetti/MegasimOnePainel/main/imagens/docs/diagrams/ux-data-flow-map.svg)